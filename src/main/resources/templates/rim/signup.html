<!DOCTYPE html>
<html lang="en"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layout_dir/layout/main_layout}">
<head>
    <meta charset="UTF-8">
    <title>회원가입</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/js/rim/api.js"></script>
    <link rel="stylesheet" href="/css/common/variable.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/css/signup.css">
    <style>

        .signup{
            box-sizing: border-box;
            display: flex;
            width: 100vw;
            justify-content: center;
            margin-bottom: 100px;
        }
 
        .signup-container {
            margin-top: 40px;
            width: 500px;
            display: flex;
            flex-direction: column;
        }

        .signup-container-top{
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            /*background-color: #45a049;*/
            border-bottom: 3px solid #a58c7a;
        }
        .signup-container-bottom{
            padding-top: 40px;
            border-radius: 10px;
            width: 100%;
        }
        h2 {
            font-weight: 550;
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            font-size: 14px;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 14px;
            box-sizing: border-box;
        }


        input:focus {
            outline: none;
            border-color: #929AA2;
        }

        .id-group {
            display: flex;
            gap: 10px;
        }

        .id-group input {
            flex: 1;
        }

        .rim-btn{
            border-radius: 15px;
            padding: 10px 20px;
            background: var(--primary-color-2);
            cursor: pointer;
        }
        .check-button {
            width: 150px;
            color: white;
            border: none;
            white-space: nowrap;
        }

        .check-button:hover {
            background: #B76737;
        }

        .submit-button {
            width: 100%;
            padding: 12px;
            background: var(--primary-color-2);
            color: white;
            border: none;

            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }

        /*.submit-button:hover {*/
        /*    background: var(--primary-color-1);*/
        /*}*/

        .email-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .email-group input {
            flex: 1;
        }

        .email-group span {
            color: #666;
        }

        .birth-group {
            display: flex;
            gap: 10px;
        }

        .birth-group select {
            flex: 1;
        }

        .error-message {
            color: #f44336;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .required::after {
            content: " *";
            color: #f44336;
        }

        .signup-container-top h2 {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .signup-container-top h2 i {
            color: var(--primary-color-1);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 70%;
            max-width: 600px;
            border-radius: 10px;
        }

        #modalContent {
            font-weight: normal;
            color: #333333;
            font-size: 14px;
            white-space: pre-wrap;
            text-align: left;
            padding: 20px;
        }

        /* 조항 제목 스타일 */
        #modalContent .article-title {
            display: block;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* 들여쓰기 적용 */
        #modalContent span + br + * {
            padding-left: 20px;
            display: block;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }


        .modal-body {
            max-height: 400px;
            overflow-y: auto;
            line-height: 1.6;      /* 줄간격 조정 */
            padding: 0;            /* 기존 패딩 제거 */
        }

        .modal-body p {
            margin: 8px 0;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: black;
        }

        .terms-view {
            margin-left: auto;
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: none;
            cursor: pointer;
            font-size: 12px;
        }

        .terms-view:hover {
            background-color: #f5f5f5;
        }

        /* terms 관련 스타일 추가 */
        .terms-container {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
        }

        .terms-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .terms-checkbox {
            width: auto !important;  /* 기존 input 스타일 override */
            margin-right: 10px;
        }

        .terms-item label {
            margin-bottom: 0;  /* 기존 label 스타일 override */
            display: inline;   /* 기존 block에서 변경 */
        }

        .terms-notice {
            margin: 5px 0 10px;
            font-size: 12px;
            color: #888;
            line-height: 1.4;
        }

        .terms-notice p {
            margin: 2px 0;
        }

        /* 약관 컨테이너와의 간격 조정 */
        .terms-container {
            margin-top: 5px;
        }

    </style>
</head>
<body>
<div layout:fragment="content">
    <div class="signup">
        <div class="signup-container">
            <div class="signup-container-top">
                <h2>
                    <i class="fa-solid fa-user-plus" ></i>
                    구직자 회원가입
                </h2>
            </div>
            <div class="signup-container-bottom">
                <form id="signupForm">
                    <div class="form-group">
                        <label for="userId" class="required">아이디</label>
                        <div class="id-group">
                            <input type="text" id="userId" placeholder="영문, 숫자 4~20자">
                            <button type="button" class="rim-btn check-button" onclick="checkDuplicate()">중복확인</button>
                        </div>
                        <div class="error-message" id="userIdError"></div>
                    </div>

                    <div class="form-group">
                        <label for="userPw" class="required">비밀번호</label>
                        <input type="password" id="userPw" placeholder="영문, 숫자, 특수문자 조합 8자 이상">
                        <div class="error-message" id="userPwError"></div>
                    </div>

                    <div class="form-group">
                        <label for="userPwConfirm" class="required">비밀번호 확인</label>
                        <input type="password" id="userPwConfirm" placeholder="비밀번호 재입력" >
                        <div class="error-message" id="userPwConfirmError"></div>
                    </div>

                    <div class="form-group">
                        <label for="userName" class="required">이름</label>
                        <input type="text" id="userName" >
                        <div class="error-message" id="userNameError"></div>
                    </div>

                    <div class="form-group">
                        <label for="userPhone" class="required">휴대폰 번호</label>
                        <input type="tel" id="userPhone" placeholder="000-0000-0000" >
                        <div class="error-message" id="userPhoneError"></div>
                    </div>

                    <div class="form-group">
                        <label class="required">이메일</label>
                        <div class="email-group">
                            <input type="text" id="emailId" >
                            <span>@</span>
                            <input type="text" id="emailDomain" >
                        </div>
                        <div class="error-message" id="userEmailError"></div>
                    </div>

                    <div class="form-group">
                        <label class="required">생년월일</label>
                        <div class="birth-group">
                            <select id="birthYear" >
                                <option value="">년도</option>
                            </select>
                            <select id="birthMonth" >
                                <option value="">월</option>
                            </select>
                            <select id="birthDay" >
                                <option value="">일</option>
                            </select>
                        </div>
                        <div class="error-message" id="userBirthError"></div>
                    </div>

                    <div class="form-group">
                        <label class="required">성별</label>
                        <select id="userGender">
                            <option value="">선택</option>
                            <option value="M">남성</option>
                            <option value="F">여성</option>
                        </select>
                        <div class="error-message" id="userGenderError"></div>
                    </div>

                    <div class="form-group">
                        <label class="required">약관 동의</label>
                        <div class="terms-notice">
                            <p>회원가입을 위해서는 약관을 확인하고 동의해주세요.</p>
                            <p>각 약관의 '보기' 버튼을 클릭하여 내용 확인 후 동의가 가능합니다.</p>
                        </div>
                        <div class="terms-container">
                            <div class="terms-item">
                                <input type="checkbox" id="termsAll" class="terms-checkbox">
                                <label for="termsAll" style="display: inline;">전체 동의</label>
                            </div>
                            <div class="terms-item">
                                <input type="checkbox" id="terms1" class="terms-checkbox required-terms">
                                <label for="terms1" style="display: inline;">[필수] 이용약관 동의</label>
                                <button type="button" class="terms-view" data-term-type="1">보기</button>
                            </div>
                            <div class="terms-item">
                                <input type="checkbox" id="terms2" class="terms-checkbox required-terms">
                                <label for="terms2" style="display: inline;">[필수] 개인정보 수집 및 이용 동의</label>
                                <button type="button" class="terms-view" data-term-type="2">보기</button>
                            </div>
                        </div>
                        <div class="error-message" id="termsError"></div>
                    </div>

                    <button type="submit" class="rim-btn submit-button">가입하기</button>
                </form>
            </div>
        </div>

    </div>

    <div id="termsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle"></h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="modalContent"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="rim-btn check-button" onclick="agreeToTerms()">동의</button>
            </div>
        </div>
    </div>
</div>

<th:block layout:fragment="script">
    <script>
        // 약관 체크박스 초기 비활성화
        document.querySelectorAll('.required-terms').forEach(checkbox => {
            checkbox.disabled = true;  // 체크박스 비활성화
        });

        let currentTermType = null;  // 현재 보고 있는 약관 타입 저장

        // 약관 내용 표시 함수
        function showTerms(termType) {
            const modal = document.getElementById('termsModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            const checkbox = document.getElementById(`terms${termType}`);

            let title = '';
            let content = '';

            switch(termType) {
                case 1:
                    title = '이용약관';
                    content = `제1조(목적) 이 약관은 주식회사 2WH(전자상거래 사업자)가 운영하는 2WH 사이버 몰(이하 "몰"이라 한다)에서 제공하는 인터넷 관련 서비스(이하 "서비스"라 한다)를 이용함에 있어 사이버 몰과 이용자의 권리․의무 및 책임사항을 규정함을 목적으로 합니다.

                    제2조(정의)
                    ① "몰"이란 주식회사 2WH가 재화 또는 용역(이하 "재화 등"이라 함)을 이용자에게 제공하기 위하여 컴퓨터 등 정보통신설비를 이용하여 재화 등을 거래할 수 있도록 설정한 가상의 영업장을 말하며, 아울러 사이버몰을 운영하는 사업자의 의미로도 사용합니다.`;
                                        break;
                                    case 2:
                                        title = '개인정보 수집 및 이용 동의';
                                        content = `1. 수집하는 개인정보의 항목
                    회사는 회원가입, 상담, 서비스 신청 등을 위해 아래와 같은 개인정보를 수집하고 있습니다.
                    ο 수집항목 : 이름 , 로그인ID , 비밀번호 , 자택 전화번호 , 자택 주소 , 휴대전화번호 , 이메일 , 서비스 이용기록 , 접속 로그 , 쿠키 , 접속 IP 정보
                    ο 개인정보 수집방법 : 홈페이지(회원가입)`;
                                        break;
                                    case 3:
                                        title = '위치기반서비스 이용약관';
                                        content = `제1조 (목적)
                    본 약관은 회사가 제공하는 위치기반서비스와 관련하여 회사와 개인위치정보주체와의 권리, 의무 및 책임사항, 기타 필요한 사항을 규정함을 목적으로 합니다.

                    제2조 (약관의 효력 및 변경)
                    ① 본 약관은 서비스를 신청한 고객 또는 개인위치정보주체가 본 약관에 동의하고 회사가 정한 소정의 절차에 따라 서비스의 이용자로 등록함으로써 효력이 발생합니다.`;
                                        break;
            }

            modalTitle.textContent = title;
            modalContent.textContent = content;
            modal.style.display = "block";

            // 약관 확인 시 체크박스 활성화
            checkbox.disabled = false;
        }
        
        // 약관 동의 처리 함수 . 현재 선택된 약관에 대해 체크박스를 체크하고 모달을 닫는다
        function agreeToTerms() {
            if (currentTermType) {
                const checkbox = document.getElementById(`terms${currentTermType}`);
                checkbox.checked = true;
                
                // 전체 동의 상태 업데이트
                const allChecked = [...document.querySelectorAll('.required-terms')]
                    .every(box => box.checked);
                document.getElementById('termsAll').checked = allChecked;
                
                // 모달 닫기
                document.getElementById('termsModal').style.display = "none";
            }
        }

        // 유효성 검사 규칙 객체
        const validationRules = {
            userId: {
                pattern: /^[a-zA-Z0-9]{4,20}$/,
                message: '아이디는 영문, 숫자 4~20자여야 합니다'
            },
            userPw: {
                pattern: /^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/,
                message: '비밀번호는 영문, 숫자, 특수문자 조합 8자 이상이어야 합니다'
            },
            userPwConfirm: {
                validate: (value, formData) => value === formData.userPw,
                message: '비밀번호가 일치하지 않습니다'
            },
            userName: {
                pattern: /^.{2,}$/,
                message: '이름은 2자 이상이어야 합니다'
            },
            userPhone: {
                pattern: /^\d{3}-\d{3,4}-\d{4}$/,
                message: '올바른 전화번호 형식이 아닙니다'
            },
            userEmail: {
                validate: (value) => {
                    const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
                    return emailPattern.test(value);
                },
                message: '올바른 이메일 형식이 아닙니다'
            },
            emailDomain: {
                pattern: /^[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/,
                message: '올바른 도메인 형식이 아닙니다 (예: gmail.com)'
            }
        };

        // 유효성 검사 함수
        const validateField = (fieldName, value, formData) => {
            const rule = validationRules[fieldName];
            if (!rule) return true;

            if (rule.pattern) {
                return rule.pattern.test(value);
            }
            if (rule.validate) {
                return rule.validate(value, formData);
            }
            return true;
        };

        // 에러 메시지 표시 함수
        const showError = (fieldName, message) => {
            const errorDiv = document.getElementById(`${fieldName}Error`);
            if (errorDiv) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
            }
        };

        // 에러 메시지 초기화 함수
        const clearErrors = () => {
            document.querySelectorAll('.error-message').forEach(div => {
                div.style.display = 'none';
                div.textContent = '';
            });
        };

        // 아이디 검증
        function validateUserId() {
            const userId = document.getElementById('userId').value;
            if (!userId) {
                showError('userId', '아이디는 필수 입력 항목입니다.');
                document.getElementById('userId').focus();
                return false;
            }

            if (!validationRules.userId.pattern.test(userId)) {
                showError('userId', validationRules.userId.message);
                document.getElementById('userId').focus();
                return false;
            }

            // 중복확인 여부 검증
            const isValidated = document.getElementById('userId').getAttribute('data-validated') === 'true';
            if (!isValidated) {
                showError('userId', '아이디 중복확인이 필요합니다.');
                document.getElementById('userId').focus();
                return false;
            }

            return true;
        }

        // 비밀번호 검증
        function validatePassword() {
            const userPw = document.getElementById('userPw').value;
            if (!userPw) {
                showError('userPw', '필수 입력 항목입니다.');
                document.getElementById('userPw').focus();
                return false;
            }

            if (!validationRules.userPw.pattern.test(userPw)) {
                showError('userPw', validationRules.userPw.message);
                document.getElementById('userPw').focus();
                return false;
            }

            const userPwConfirm = document.getElementById('userPwConfirm').value;
            if (!userPwConfirm) {
                showError('userPwConfirm', '필수 입력 항목입니다.');
                document.getElementById('userPwConfirm').focus();
                return false;
            }

            if (userPw !== userPwConfirm) {
                showError('userPwConfirm', '비밀번호가 일치하지 않습니다.');
                document.getElementById('userPwConfirm').focus();
                return false;
            }

            return true;
        }

        // 이름 검증
        function validateName() {
            const userName = document.getElementById('userName').value;
            if (!userName) {
                showError('userName', '필수 입력 항목입니다.');
                document.getElementById('userName').focus();
                return false;
            }

            if (!validationRules.userName.pattern.test(userName)) {
                showError('userName', validationRules.userName.message);
                document.getElementById('userName').focus();
                return false;
            }

            return true;
        }

        // 휴대폰 번호 검증
        function validatePhone() {
            const userPhone = document.getElementById('userPhone').value;
            if (!userPhone) {
                showError('userPhone', '필수 입력 항목입니다.');
                document.getElementById('userPhone').focus();
                return false;
            }

            if (!validationRules.userPhone.pattern.test(userPhone)) {
                showError('userPhone', validationRules.userPhone.message);
                document.getElementById('userPhone').focus();
                return false;
            }

            return true;
        }

        // 나머지 필수 필드 검증
        function validateRemainingFields() {
            const fields = ['emailId', 'emailDomain', 'birthYear', 'birthMonth', 'birthDay', 'userGender'];
            
            for (const field of fields) {
                const value = document.getElementById(field)?.value;
                if (!value) {
                    const errorField = field === 'emailId' || field === 'emailDomain' ? 'userEmail' : field;
                    showError(errorField, '필수 입력 항목입니다.');
                    document.getElementById(field).focus();
                    return false;
                }

                // 이메일 도메인 패턴 검사 추가
                if (field === 'emailDomain' && !validationRules.emailDomain.pattern.test(value)) {
                    showError('userEmail', validationRules.emailDomain.message);
                    document.getElementById(field).focus();
                    return false;
                }
            }

            return true;
        }

        // 약관 동의 검증
        function validateTerms() {
            const requiredTerms = document.querySelectorAll('.required-terms');
            const isAllTermsChecked = [...requiredTerms].every(checkbox => checkbox.checked);
            if (!isAllTermsChecked) {
                showError('terms', '필수 약관에 모두 동의해주세요.');
                return false;
            }
            return true;
        }

        // 폼 제출 처리
        const form = document.getElementById('signupForm');
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            clearErrors();

            // 순차적 검증
            if (!validateUserId()) return;
            if (!validatePassword()) return;
            if (!validateName()) return;
            if (!validatePhone()) return;
            if (!validateRemainingFields()) return;
            if (!validateTerms()) return;

            // API 호출을 위한 데이터 준비
                const formData = {
                    userId: document.getElementById('userId').value,
                    userPw: document.getElementById('userPw').value,
                    userPwConfirm: document.getElementById('userPwConfirm').value,
                    userName: document.getElementById('userName').value,
                    userPhone: document.getElementById('userPhone').value,
                    userEmail: `${document.getElementById('emailId').value}@${document.getElementById('emailDomain').value}`,
                userBirth: `${document.getElementById('birthYear').value}${
                    document.getElementById('birthMonth').value.padStart(2, '0')}${
                    document.getElementById('birthDay').value.padStart(2, '0')}`,
                    userGender: document.getElementById('userGender').value
                };

            // API 호출
            try {
                const response = await axios.post('/api/auth/signup', formData);
                alert(response.data.body);  // 성공 메시지
                location.href = '/login';
            } catch (error) {
                console.log(error);
                if (error.response?.status === 400) {
                    const errorResponse = error.response.data;
                    if (typeof errorResponse.body === 'string') {
                        // 단일 에러 메시지 (예: "이미 사용중인 이메일입니다")
                        alert(errorResponse.body);
                    } else {
                        // ValidationError의 경우 (필드별 에러)
                        Object.entries(errorResponse.body).forEach(([field, message]) => {
                            showError(field, message);
                        });
                    }
                } else {
                    alert(error.response?.data?.body || '회원가입 중 오류가 발생했습니다');
                }
            }
        });

        // 전화번호 자동 하이픈 추가
        document.getElementById('userPhone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/[^0-9]/g, '');
            if (value.length > 3 && value.length <= 7) {
                value = value.slice(0,3) + '-' + value.slice(3);
            } else if (value.length > 7) {
                value = value.slice(0,3) + '-' + value.slice(3,7) + '-' + value.slice(7,11);
            }
            e.target.value = value;
        });

        // 생년월일 셀렉트 박스 초기화
        function initBirthSelect() {
            const yearSelect = document.getElementById('birthYear');
            const monthSelect = document.getElementById('birthMonth');
            const daySelect = document.getElementById('birthDay');

            const currentYear = new Date().getFullYear();
            for (let year = currentYear; year >= currentYear - 100; year--) {
                yearSelect.add(new Option(year, year));
            }

            for (let month = 1; month <= 12; month++) {
                monthSelect.add(new Option(month, month.toString().padStart(2, '0')));
            }

            for (let day = 1; day <= 31; day++) {
                daySelect.add(new Option(day, day.toString().padStart(2, '0')));
            }
        }

        // 페이지 로드 시 초기화
        initBirthSelect();

        // 아이디 중복확인 함수 수정
        async function checkDuplicate() {
            const userId = document.getElementById('userId').value;
            if (!validationRules.userId.pattern.test(userId)) {
                showError('userId', validationRules.userId.message);
                document.getElementById('userId').focus();
                return;
            }

            try {
                const response = await axios.post('/api/auth/check-duplicate', { userId });
                console.log('signup.html -> response',response);
                console.log('signup.html -> response.body',response.body);
                if (response.body.success) {  // status 대신 state 확인
                    clearErrors();
                    alert('사용 가능한 아이디입니다.');
                    document.getElementById('userId').setAttribute('data-validated', 'true');
                } else {
                    showError('userId', '이미 사용중인 아이디입니다.');
                    document.getElementById('userId').setAttribute('data-validated', 'false');
                    document.getElementById('userId').focus();
                }
            } catch (error) {
                alert(error?.body || '중복 확인 중 오류가 발생했습니다.');
                document.getElementById('userId').focus();
            }
        }

        // userId input에 변경이 있을 때마다 validated 상태를 false로 변경하고 에러 메시지 표시
        document.getElementById('userId').addEventListener('input', function() {
            this.setAttribute('data-validated', 'false');
            if (this.value) {  // 값이 있을 경우에만
                showError('userId', '아이디 중복확인이 필요합니다.');
            } else {
                clearErrors();  // 값이 없으면 에러메시지 제거
            }
        });

        // 전체 동의 체크박스 처리 수정
        document.getElementById('termsAll').addEventListener('change', function() {
            const checkboxes = document.querySelectorAll('.terms-checkbox');
            checkboxes.forEach(checkbox => {
                // 비활성화된 체크박스는 체크하지 않음
                if (!checkbox.disabled) {
                    checkbox.checked = this.checked;
                }
            });
        });

        // 개별 체크박스 변경 시 전체 동의 체크박스 상태 업데이트
        document.querySelectorAll('.required-terms').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const allChecked = [...document.querySelectorAll('.required-terms')]
                    .every(box => box.checked);
                document.getElementById('termsAll').checked = allChecked;
            });
        });

        // 모달 닫기 기능
        document.querySelector('.close').addEventListener('click', function() {
            document.getElementById('termsModal').style.display = "none";
        });

        // 모달 외부 클릭 시 닫기
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('termsModal');
            if (event.target == modal) {
                modal.style.display = "none";
            }
        });

        // JavaScript에서 이벤트 리스너 추가
        document.querySelectorAll('.terms-view').forEach(button => {
            button.addEventListener('click', function() {
                const termType = this.getAttribute('data-term-type');
                showTerms(parseInt(termType));
            });
        });

        // 체크박스 직접 클릭 방지
        document.querySelectorAll('.required-terms').forEach(checkbox => {
            checkbox.addEventListener('click', function(e) {
                if (this.disabled) {
                    e.preventDefault();
                    alert('약관을 확인하고 동의해주세요.');
                }
            });
        });
    </script>
</th:block>
</body>
</html>