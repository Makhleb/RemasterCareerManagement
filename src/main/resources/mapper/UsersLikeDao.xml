<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.test.dao.sangin.UsersLikeDao_sangin">
<!--유저의 관심 공고 수-->
    <select id="jplCount" resultType="java.lang.Integer">
        select count(*) from tblJpl where userId = #{userId}
    </select>
<!--유저의 관심 기업 수-->
    <select id="clCount" resultType="java.lang.Integer">
        select count(*) from tblLike where userId = #{userId}
    </select>
<!--유저가 관심있는 공고-->
    <select id="jobPostLike" resultType="com.example.test.vo.JobPostDetailVo">
        SELECT
        jp.*,
        gb.name AS workTypeName,
<!--    work 타입 코드 변환    -->
        c.companyName,
<!--    회사 이름 조인         -->
        (SELECT COUNT(*)
        FROM tblJpl l2
        WHERE l2.jobPostNo = jp.jobPostNo) AS likeCount
<!--    공고가 테이블에 올라온 수 == 지원자 수    -->
        FROM
        tblJobPost jp
        INNER JOIN
        tblJpl l
        ON jp.jobPostNo = l.jobPostNo
        LEFT JOIN
        tblGubn gb
        ON jp.workTypeCode = gb.code
        LEFT JOIN
        tblCompany c
        ON jp.companyId = c.companyId
        WHERE
        l.userId = #{userId}
    </select>
    <!--유저가 관심있는 기업-->
    <select id="companyLike" resultType="com.example.test.vo.LikeCompanyVo">
        SELECT cp.*
        FROM tblCompany cp
        INNER JOIN tblLike l ON cp.companyId = l.companyId
        WHERE l.userId = #{userId}
    </select>
    <select id="jobPostByCompanyId">
<!-- 12.31 15:44 조금있다 추가할 예정..-->
        select * from tblJobPost where companyId = #{companyId}
        ORDER BY RAND()
        LIMIT 3
    </select>
</mapper>